// @via https://github.com/Gozala/micro-promise
// $ npm install micro-promise

!function(e){if(typeof define==="function"){define(e)}else if(typeof exports==="object"){e(require,exports)}else if(~String(this).indexOf("BackstagePass")){e(undefined,this);this.EXPORTED_SYMBOLS=Object.keys(this)}else{e(undefined,this.promise={})}}.call(this,function(e,t){"use strict";function n(e){return{then:function(n){n(e)}}}function r(e){return{then:function(n,r){r(e)}}}function i(e){return function(n){try{return e(n)}catch(i){return r(i)}}}function s(e){return e&&typeof e.then==="function"}function o(e){var t=[],u;e=e||e===null?e:Object.prototype;var a=Object.create(e,{then:{value:function(a,f){function c(e){l.resolve(a(e))}function h(e){l.resolve(f(e))}var l=o(e);a=a?i(a):n;f=f?i(f):r;if(t)t.push([c,h]);else u.then(c,h);return l.promise}}});var f={promise:a,resolve:function(r){if(t){u=s(r)?r:n(r);while(t.length)u.then.apply(u,t.shift());t=null}},reject:function(t){f.resolve(r(t))}};return f}function u(e,t){var n=o(t);n.resolve(e);return n.promise}function a(e,t){var n=o(t);n.reject(e);return n.promise}t.defer=o;t.resolve=u;t.reject=a;var f=function(){function n(t){return e.apply(e,t)}function r(e,t){return e.then(function(e){return u(t).then(function(t){return e.concat(t)})})}var e=Function.call;var t=Array.prototype.concat;return function(i,s){return function(){return t.apply([i,this],arguments).reduce(r,u([],s)).then(n)}}}();t.promised=f})